import '../../models/user_profile.dart';
import '../../models/exercise_type.dart';
import 'package:flutter/material.dart';

/// Ïö¥Îèô ÏÑ∏Ìä∏ Ï†ïÎ≥¥
class ExerciseSet {
  final ExerciseType type;
  final int reps;

  const ExerciseSet({required this.type, required this.reps});
}

/// ÏùºÏùº Ïö¥Îèô ÌîÑÎ°úÍ∑∏Îû®
class DailyWorkout {
  final List<int> sets;
  final int restTimeSeconds;

  const DailyWorkout({
    required this.sets,
    this.restTimeSeconds = 90,
  });

  /// Ï¥ù ÌöüÏàò
  int get totalReps => sets.fold(0, (sum, reps) => sum + reps);

  /// ExerciseSet Î¶¨Ïä§Ìä∏Î°ú Î≥ÄÌôò
  List<ExerciseSet> toSets() {
    return sets
        .map((reps) => ExerciseSet(type: ExerciseType.pushup, reps: reps))
        .toList();
  }

  /// Ï¥ù ÌöüÏàò (ÌïòÏúÑ Ìò∏ÌôòÏÑ±)
  int getTotalReps() => totalReps;
}

/// 14Ï£º Ìë∏Ïâ¨ÏóÖ ÌîÑÎ°úÍ∑∏Îû® Îç∞Ïù¥ÌÑ∞
///
/// Í≥ºÌïôÏ†Å Í∑ºÍ±∞: Calatayud J, et al. (2017). IJERPH. 14(5):358
///
/// Í≥ºÌïôÏ†Å ÌîÑÎ°úÍ∑∏Î†àÏãúÎ∏å Ïò§Î≤ÑÎ°úÎìú Ï†ÅÏö©:
/// - Rookie: 12 ‚Üí 100 reps
/// - Rising: 18 ‚Üí 120 reps
/// - Alpha: 30 ‚Üí 150 reps
/// - Giga: 50 ‚Üí 200 reps
class WorkoutData {
  /// 14Ï£º ÏõåÌÅ¨ÏïÑÏõÉ ÌîÑÎ°úÍ∑∏Îû® Îç∞Ïù¥ÌÑ∞
  /// Map<ÎÇúÏù¥ÎèÑ, Map<Ï£ºÏ∞®, Map<ÏöîÏùº, List<ÏÑ∏Ìä∏Î≥Ñ ÌöüÏàò>>>>
  static Map<UserLevel, Map<int, Map<int, List<int>>>> get workoutPrograms => {
        // Ï¥àÍ∏â Î†àÎ≤® (Rookie Chad) - 12 ‚Üí 100 reps
        UserLevel.rookie: {
          1: {
            1: [3, 2, 2, 2, 3], // Ï¥ù 12Í∞ú
            2: [4, 2, 2, 2, 3], // Ï¥ù 13Í∞ú
            3: [3, 3, 3, 3, 3], // Ï¥ù 15Í∞ú
          },
          2: {
            1: [2, 3, 3, 3, 3], // Ï¥ù 14Í∞ú
            2: [3, 3, 3, 3, 3], // Ï¥ù 15Í∞ú
            3: [5, 3, 3, 3, 4], // Ï¥ù 18Í∞ú
          },
          3: {
            1: [4, 3, 3, 3, 3], // Ï¥ù 16Í∞ú
            2: [5, 3, 3, 3, 4], // Ï¥ù 18Í∞ú
            3: [4, 3, 3, 3, 3, 4], // Ï¥ù 20Í∞ú
          },
          4: {
            1: [3, 4, 4, 4, 4], // Ï¥ù 19Í∞ú
            2: [4, 4, 3, 3, 3, 4], // Ï¥ù 21Í∞ú
            3: [4, 4, 4, 4, 4, 4], // Ï¥ù 24Í∞ú
          },
          5: {
            1: [4, 4, 4, 4, 3, 4], // Ï¥ù 23Í∞ú
            2: [4, 4, 4, 4, 4, 5], // Ï¥ù 25Í∞ú
            3: [5, 5, 5, 5, 4, 5], // Ï¥ù 29Í∞ú
          },
          6: {
            1: [5, 5, 4, 4, 4, 5], // Ï¥ù 27Í∞ú
            2: [4, 5, 5, 5, 5, 6], // Ï¥ù 30Í∞ú
            3: [7, 6, 5, 5, 5, 6], // Ï¥ù 34Í∞ú
          },
          7: {
            1: [5, 5, 5, 5, 5, 6], // Ï¥ù 31Í∞ú
            2: [7, 6, 5, 5, 5, 6], // Ï¥ù 34Í∞ú
            3: [7, 7, 6, 6, 6, 7], // Ï¥ù 39Í∞ú
          },
          8: {
            1: [6, 6, 6, 6, 6, 7], // Ï¥ù 37Í∞ú
            2: [6, 7, 7, 7, 6, 8], // Ï¥ù 41Í∞ú
            3: [9, 8, 7, 7, 7, 9], // Ï¥ù 47Í∞ú
          },
          9: {
            1: [8, 7, 7, 7, 7, 8], // Ï¥ù 44Í∞ú
            2: [8, 8, 8, 8, 7, 9], // Ï¥ù 48Í∞ú
            3: [10, 8, 8, 8, 7, 7, 8], // Ï¥ù 56Í∞ú
          },
          10: {
            1: [9, 8, 8, 7, 7, 6, 7], // Ï¥ù 52Í∞ú
            2: [9, 9, 9, 8, 7, 7, 8], // Ï¥ù 57Í∞ú
            3: [11, 10, 10, 9, 9, 8, 9], // Ï¥ù 66Í∞ú
          },
          11: {
            1: [10, 9, 9, 9, 8, 7, 9], // Ï¥ù 61Í∞ú
            2: [12, 10, 10, 9, 9, 8, 9], // Ï¥ù 67Í∞ú
            3: [12, 12, 12, 11, 10, 9, 11], // Ï¥ù 77Í∞ú
          },
          12: {
            1: [12, 11, 11, 10, 9, 9, 10], // Ï¥ù 72Í∞ú
            2: [13, 12, 12, 11, 10, 10, 11], // Ï¥ù 79Í∞ú
            3: [14, 14, 14, 13, 12, 11, 13], // Ï¥ù 91Í∞ú
          },
          13: {
            1: [13, 13, 13, 12, 11, 10, 12], // Ï¥ù 84Í∞ú
            2: [15, 14, 14, 13, 12, 11, 13], // Ï¥ù 92Í∞ú
            3: [18, 16, 16, 15, 14, 13, 15], // Ï¥ù 107Í∞ú
          },
          14: {
            1: [17, 15, 15, 14, 13, 12, 14], // Ï¥ù 100Í∞ú
            2: [21, 16, 16, 15, 14, 13, 15], // Ï¥ù 110Í∞ú
            3: [22, 19, 19, 18, 16, 15, 18], // Ï¥ù 127Í∞ú
          },
        },

        // Ï§ëÍ∏â Î†àÎ≤® (Rising Chad) - 18 ‚Üí 120 reps
        UserLevel.rising: {
          1: {
            1: [5, 3, 3, 3, 4], // Ï¥ù 18Í∞ú
            2: [4, 3, 3, 3, 3, 4], // Ï¥ù 20Í∞ú
            3: [4, 4, 4, 4, 3, 4], // Ï¥ù 23Í∞ú
          },
          2: {
            1: [4, 3, 3, 3, 3, 4], // Ï¥ù 20Í∞ú
            2: [3, 4, 4, 4, 3, 4], // Ï¥ù 22Í∞ú
            3: [4, 4, 4, 4, 4, 5], // Ï¥ù 25Í∞ú
          },
          3: {
            1: [4, 4, 4, 4, 4, 4], // Ï¥ù 24Í∞ú
            2: [5, 4, 4, 4, 4, 5], // Ï¥ù 26Í∞ú
            3: [4, 5, 5, 5, 5, 6], // Ï¥ù 30Í∞ú
          },
          4: {
            1: [5, 5, 4, 4, 4, 5], // Ï¥ù 27Í∞ú
            2: [4, 5, 5, 5, 5, 6], // Ï¥ù 30Í∞ú
            3: [7, 6, 5, 5, 5, 6], // Ï¥ù 34Í∞ú
          },
          5: {
            1: [6, 5, 5, 5, 5, 6], // Ï¥ù 32Í∞ú
            2: [5, 6, 6, 6, 5, 7], // Ï¥ù 35Í∞ú
            3: [6, 7, 7, 7, 6, 8], // Ï¥ù 41Í∞ú
          },
          6: {
            1: [6, 6, 6, 6, 6, 7], // Ï¥ù 37Í∞ú
            2: [6, 7, 7, 7, 6, 8], // Ï¥ù 41Í∞ú
            3: [9, 8, 7, 7, 7, 9], // Ï¥ù 47Í∞ú
          },
          7: {
            1: [8, 7, 7, 7, 6, 8], // Ï¥ù 43Í∞ú
            2: [9, 8, 7, 7, 7, 9], // Ï¥ù 47Í∞ú
            3: [9, 8, 8, 8, 7, 7, 8], // Ï¥ù 55Í∞ú
          },
          8: {
            1: [9, 8, 8, 8, 7, 9], // Ï¥ù 49Í∞ú
            2: [8, 8, 8, 8, 7, 7, 8], // Ï¥ù 54Í∞ú
            3: [11, 9, 9, 9, 8, 7, 9], // Ï¥ù 62Í∞ú
          },
          9: {
            1: [9, 9, 9, 8, 7, 7, 8], // Ï¥ù 57Í∞ú
            2: [11, 9, 9, 9, 8, 8, 9], // Ï¥ù 63Í∞ú
            3: [12, 11, 11, 10, 9, 9, 10], // Ï¥ù 72Í∞ú
          },
          10: {
            1: [11, 10, 10, 9, 9, 8, 9], // Ï¥ù 66Í∞ú
            2: [13, 11, 11, 10, 9, 9, 10], // Ï¥ù 73Í∞ú
            3: [13, 13, 13, 12, 11, 10, 12], // Ï¥ù 84Í∞ú
          },
          11: {
            1: [12, 12, 12, 11, 10, 9, 11], // Ï¥ù 77Í∞ú
            2: [14, 13, 13, 12, 11, 10, 12], // Ï¥ù 85Í∞ú
            3: [15, 15, 15, 14, 13, 12, 14], // Ï¥ù 98Í∞ú
          },
          12: {
            1: [16, 13, 13, 12, 12, 11, 12], // Ï¥ù 89Í∞ú
            2: [15, 15, 15, 14, 13, 12, 14], // Ï¥ù 98Í∞ú
            3: [18, 17, 17, 16, 15, 14, 16], // Ï¥ù 113Í∞ú
          },
          13: {
            1: [20, 15, 15, 14, 13, 12, 14], // Ï¥ù 103Í∞ú
            2: [18, 17, 17, 16, 15, 14, 16], // Ï¥ù 113Í∞ú
            3: [22, 20, 20, 18, 17, 16, 18], // Ï¥ù 131Í∞ú
          },
          14: {
            1: [19, 18, 18, 17, 16, 15, 17], // Ï¥ù 120Í∞ú
            2: [23, 20, 20, 18, 17, 16, 18], // Ï¥ù 132Í∞ú
            3: [26, 23, 23, 21, 20, 18, 21], // Ï¥ù 152Í∞ú
          },
        },

        // Í≥†Í∏â Î†àÎ≤® (Alpha Chad) - 30 ‚Üí 150 reps
        UserLevel.alpha: {
          1: {
            1: [4, 5, 5, 5, 5, 6], // Ï¥ù 30Í∞ú
            2: [6, 6, 5, 5, 5, 6], // Ï¥ù 33Í∞ú
            3: [7, 6, 6, 6, 6, 7], // Ï¥ù 38Í∞ú
          },
          2: {
            1: [6, 6, 5, 5, 5, 6], // Ï¥ù 33Í∞ú
            2: [6, 6, 6, 6, 5, 7], // Ï¥ù 36Í∞ú
            3: [7, 7, 7, 7, 6, 8], // Ï¥ù 42Í∞ú
          },
          3: {
            1: [7, 6, 6, 6, 6, 7], // Ï¥ù 38Í∞ú
            2: [7, 7, 7, 7, 6, 8], // Ï¥ù 42Í∞ú
            3: [8, 8, 8, 8, 7, 9], // Ï¥ù 48Í∞ú
          },
          4: {
            1: [8, 7, 7, 7, 6, 8], // Ï¥ù 43Í∞ú
            2: [9, 8, 7, 7, 7, 9], // Ï¥ù 47Í∞ú
            3: [9, 8, 8, 8, 7, 7, 8], // Ï¥ù 55Í∞ú
          },
          5: {
            1: [9, 8, 8, 8, 7, 9], // Ï¥ù 49Í∞ú
            2: [8, 8, 8, 8, 7, 7, 8], // Ï¥ù 54Í∞ú
            3: [11, 9, 9, 9, 8, 7, 9], // Ï¥ù 62Í∞ú
          },
          6: {
            1: [9, 8, 8, 8, 7, 7, 8], // Ï¥ù 55Í∞ú
            2: [10, 9, 9, 9, 8, 7, 9], // Ï¥ù 61Í∞ú
            3: [13, 10, 10, 10, 9, 8, 10], // Ï¥ù 70Í∞ú
          },
          7: {
            1: [11, 9, 9, 9, 8, 8, 9], // Ï¥ù 63Í∞ú
            2: [12, 10, 10, 10, 9, 8, 10], // Ï¥ù 69Í∞ú
            3: [14, 12, 12, 11, 10, 10, 11], // Ï¥ù 80Í∞ú
          },
          8: {
            1: [11, 11, 11, 10, 9, 9, 10], // Ï¥ù 71Í∞ú
            2: [13, 12, 12, 11, 10, 9, 11], // Ï¥ù 78Í∞ú
            3: [15, 13, 13, 13, 12, 11, 13], // Ï¥ù 90Í∞ú
          },
          9: {
            1: [14, 12, 12, 11, 10, 10, 11], // Ï¥ù 80Í∞ú
            2: [16, 13, 13, 12, 11, 11, 12], // Ï¥ù 88Í∞ú
            3: [19, 15, 15, 14, 13, 12, 14], // Ï¥ù 102Í∞ú
          },
          10: {
            1: [14, 14, 14, 13, 12, 11, 13], // Ï¥ù 91Í∞ú
            2: [17, 15, 15, 14, 13, 12, 14], // Ï¥ù 100Í∞ú
            3: [21, 17, 17, 16, 15, 14, 16], // Ï¥ù 116Í∞ú
          },
          11: {
            1: [20, 15, 15, 14, 13, 12, 14], // Ï¥ù 103Í∞ú
            2: [18, 17, 17, 16, 15, 14, 16], // Ï¥ù 113Í∞ú
            3: [22, 20, 20, 18, 17, 16, 18], // Ï¥ù 131Í∞ú
          },
          12: {
            1: [20, 18, 18, 16, 15, 14, 16], // Ï¥ù 117Í∞ú
            2: [22, 19, 19, 18, 17, 16, 18], // Ï¥ù 129Í∞ú
            3: [26, 22, 22, 21, 19, 18, 21], // Ï¥ù 149Í∞ú
          },
          13: {
            1: [23, 20, 20, 18, 17, 16, 18], // Ï¥ù 132Í∞ú
            2: [24, 22, 22, 20, 19, 18, 20], // Ï¥ù 145Í∞ú
            3: [30, 25, 25, 23, 22, 20, 23], // Ï¥ù 168Í∞ú
          },
          14: {
            1: [27, 22, 22, 21, 19, 18, 21], // Ï¥ù 150Í∞ú
            2: [28, 25, 25, 23, 21, 20, 23], // Ï¥ù 165Í∞ú
            3: [32, 28, 28, 27, 25, 23, 27], // Ï¥ù 190Í∞ú
          },
        },

        // ÎßàÏä§ÌÑ∞ Î†àÎ≤® (Giga Chad) - 50 ‚Üí 200 reps
        UserLevel.giga: {
          1: {
            1: [10, 7, 7, 7, 6, 6, 7], // Ï¥ù 50Í∞ú
            2: [9, 8, 8, 8, 7, 7, 8], // Ï¥ù 55Í∞ú
            3: [10, 10, 10, 9, 8, 8, 9], // Ï¥ù 64Í∞ú
          },
          2: {
            1: [9, 8, 8, 8, 7, 7, 8], // Ï¥ù 55Í∞ú
            2: [10, 9, 9, 9, 8, 7, 9], // Ï¥ù 61Í∞ú
            3: [13, 10, 10, 10, 9, 8, 10], // Ï¥ù 70Í∞ú
          },
          3: {
            1: [10, 9, 9, 9, 8, 7, 9], // Ï¥ù 61Í∞ú
            2: [12, 10, 10, 9, 9, 8, 9], // Ï¥ù 67Í∞ú
            3: [12, 12, 12, 11, 10, 9, 11], // Ï¥ù 77Í∞ú
          },
          4: {
            1: [13, 10, 10, 9, 9, 8, 9], // Ï¥ù 68Í∞ú
            2: [14, 11, 11, 10, 10, 9, 10], // Ï¥ù 75Í∞ú
            3: [15, 13, 13, 12, 11, 10, 12], // Ï¥ù 86Í∞ú
          },
          5: {
            1: [13, 11, 11, 11, 10, 9, 11], // Ï¥ù 76Í∞ú
            2: [13, 13, 13, 12, 11, 10, 12], // Ï¥ù 84Í∞ú
            3: [14, 15, 15, 14, 13, 12, 14], // Ï¥ù 97Í∞ú
          },
          6: {
            1: [14, 13, 13, 12, 11, 10, 12], // Ï¥ù 85Í∞ú
            2: [17, 14, 14, 13, 12, 11, 13], // Ï¥ù 94Í∞ú
            3: [19, 16, 16, 15, 14, 13, 15], // Ï¥ù 108Í∞ú
          },
          7: {
            1: [17, 14, 14, 13, 12, 11, 13], // Ï¥ù 94Í∞ú
            2: [20, 15, 15, 14, 13, 12, 14], // Ï¥ù 103Í∞ú
            3: [20, 18, 18, 17, 15, 14, 17], // Ï¥ù 119Í∞ú
          },
          8: {
            1: [16, 16, 16, 15, 14, 13, 15], // Ï¥ù 105Í∞ú
            2: [21, 17, 17, 16, 15, 14, 16], // Ï¥ù 116Í∞ú
            3: [22, 20, 20, 19, 17, 16, 19], // Ï¥ù 133Í∞ú
          },
          9: {
            1: [20, 18, 18, 16, 15, 14, 16], // Ï¥ù 117Í∞ú
            2: [22, 19, 19, 18, 17, 16, 18], // Ï¥ù 129Í∞ú
            3: [26, 22, 22, 21, 19, 18, 21], // Ï¥ù 149Í∞ú
          },
          10: {
            1: [23, 19, 19, 18, 17, 16, 18], // Ï¥ù 130Í∞ú
            2: [25, 21, 21, 20, 19, 17, 20], // Ï¥ù 143Í∞ú
            3: [28, 25, 25, 23, 21, 20, 23], // Ï¥ù 165Í∞ú
          },
          11: {
            1: [24, 22, 22, 20, 19, 18, 20], // Ï¥ù 145Í∞ú
            2: [28, 24, 24, 22, 21, 19, 22], // Ï¥ù 160Í∞ú
            3: [30, 28, 28, 26, 24, 22, 26], // Ï¥ù 184Í∞ú
          },
          12: {
            1: [29, 24, 24, 22, 21, 19, 22], // Ï¥ù 161Í∞ú
            2: [29, 27, 27, 25, 23, 21, 25], // Ï¥ù 177Í∞ú
            3: [35, 31, 31, 28, 26, 25, 28], // Ï¥ù 204Í∞ú
          },
          13: {
            1: [30, 27, 27, 25, 23, 22, 25], // Ï¥ù 179Í∞ú
            2: [31, 30, 30, 28, 26, 24, 28], // Ï¥ù 197Í∞ú
            3: [39, 34, 34, 32, 29, 27, 32], // Ï¥ù 227Í∞ú
          },
          14: {
            1: [34, 30, 30, 28, 26, 24, 28], // Ï¥ù 200Í∞ú üéØ
            2: [37, 33, 33, 31, 28, 27, 31], // Ï¥ù 220Í∞ú
            3: [44, 38, 38, 35, 33, 31, 35], // Ï¥ù 254Í∞ú
          },
        },
      };

  /// Î†àÎ≤®Î≥Ñ ÏµúÏ¢Ö Î™©Ìëú (14Ï£ºÏ∞® Day 1 Í∏∞Ï§Ä)
  static Map<UserLevel, int> get targetTotals => {
        UserLevel.rookie: 100,
        UserLevel.rising: 120,
        UserLevel.alpha: 150,
        UserLevel.giga: 200,
      };

  /// ÌäπÏ†ï Ï£ºÏ∞®Ïùò Ï¥ù Ïö¥ÎèôÎüâ Í≥ÑÏÇ∞
  static int getWeeklyTotal(UserLevel level, int week) {
    final weekData = workoutPrograms[level]?[week];
    if (weekData == null) return 0;

    int total = 0;
    for (final dayData in weekData.values) {
      total += dayData.reduce((a, b) => a + b);
    }
    return total;
  }

  /// ÌîÑÎ°úÍ∑∏Îû® ÏôÑÎ£å Ïó¨Î∂Ä ÌôïÏù∏
  static bool isWeekCompleted(
    UserLevel level,
    int week,
    Map<int, bool> completedDays,
  ) {
    final weekData = workoutPrograms[level]?[week];
    if (weekData == null) return false;

    for (final day in weekData.keys) {
      if (completedDays[day] != true) return false;
    }
    return true;
  }

  /// Î†àÎ≤®Î≥Ñ ÏÉâÏÉÅ
  static Map<UserLevel, Color> get levelColors => {
        UserLevel.rookie: const Color(0xFF4CAF50), // Green
        UserLevel.rising: const Color(0xFF2196F3), // Blue
        UserLevel.alpha: const Color(0xFFFF9800), // Orange
        UserLevel.giga: const Color(0xFFF44336), // Red
      };

  /// ÌäπÏ†ï Ï£ºÏ∞®, ÏöîÏùºÏùò DailyWorkout Í∞ÄÏ†∏Ïò§Í∏∞ (DailyWorkout ÌòïÌÉú)
  static DailyWorkout? getWorkout(UserLevel level, int week, int day) {
    final sets = workoutPrograms[level]?[week]?[day];
    if (sets == null) return null;
    return DailyWorkout(sets: sets, restTimeSeconds: 90);
  }

  /// Ï¥ù Ïö¥Îèô ÌöüÏàò Í≥ÑÏÇ∞
  static int getTotalReps(List<int> sets) {
    return sets.fold(0, (sum, reps) => sum + reps);
  }

  /// ÌîÑÎ°úÍ∑∏Îû® Ï¥ù Î™©Ìëú Îã¨ÏÑ± ÌöüÏàò
  static int getProgramTotal(UserLevel level) {
    return targetTotals[level] ?? 100;
  }

  /// RPEÎ°úÎ∂ÄÌÑ∞ Í∞ïÎèÑ Í≥ÑÏÇ∞ (ÏûÑÏãú Íµ¨ÌòÑ)
  static double calculateIntensityFromRPE(int rpe) {
    // RPE 6-10 ‚Üí Í∞ïÎèÑ 60-100%
    return (rpe * 10).toDouble();
  }

  /// ÏÑ∏Ìä∏Í∞Ñ Ìú¥Ïãù ÏãúÍ∞Ñ (Ï¥à)
  static int get restTimeSeconds => 90;

}
